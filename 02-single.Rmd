# Single sample data

## Introduction

The basic model descriptions of survival data are introduced. Basically,
the distribution of survival data may
be either _continuous_ or _discrete_, but the nonparametric
estimators\index{nonparametric estimator} of the distributions of survival
time are discrete in any case.
Therefore, when introducing the estimators, the discrete models are
necessary to know.

In the present chapter, only nonparametric estimation is discussed. This
means that no assumptions whatsoever are made about the true underlying
distribution. Parametric models are presented in Chapter 6.

## Continuous time model descriptions
\index{model!continuous|(}

Traditional statistical model descriptions are based on the
_density_\index{density function}
and the _cumulative distribution_
functions\index{cumulative distribution function}. These functions are not
so suitable for use with censored and/or truncated data. The
_survival_ and _hazard functions_ are better suited, as will be
demonstrated here. It should
however be acknowledged that all these functions are simple functions of
each other, so the information they convey is in
principle the same, it is only convenience that determines which one(s) to
choose and use in a particular application.

## The survival function
\index{survival function|(}

We start with a motivating example, the life table, and its connection to
death risks and survival probabilities in a population, see
Table \@ref(tab:lifewomen).

```{example, name = "Swedish female and male life tables 2016."}
\index{life table|(}

Statistics Sweden (SCB) is a government agency that produces
statistics and have a coordinating role for the official statistics
of Sweden. From their home page (http://www.scb.se) it is possible to
download vital
population statistics, like population size and number of deaths by age,
gender, and year. From such data it is possible to construct a _life
table_. 

Two tables are needed, one with population size by age and sex, and one with
the number of deaths by the same categories. Tables are available for age 
intervals of lengths 1, 5, and 10 years. We always prefer data with as much 
information as possible. so we choose the age interval length one. It is always 
possible to _aggregate_ later, if that is prefered.
```

First, the population data is read from the CSV file downloaded from SCB.

```{r scbpop,echo=TRUE}
pop <- read.table("Data/BE0101A6.csv", header = TRUE, 
                  stringsAsFactors = FALSE,
                  fileEncoding = "latin1")
```
The argument _stringsAsFactors = FALSE_ is needed in order to avoid character columns
being converted to factors, and _fileEncoding_ is needed to take care of some 
strange Swedish characters (å, ä, ö) in variable names and labels.

The result is shown in Table \@ref(tab:scbpoptab).

```{r scbpoptab,echo=FALSE}
##x <- list(t1 = pop[1:8, ], t2 = pop[195:202, ])
x <- pop[1:4, ]
x$X2016 <- as.character(round(x$X2016))
x <- rbind(x, rep(".....", 3))
y <- pop[199:202, ]
y$X2016 <- as.character(round(y$X2016))
x <- rbind(x, y)
rna <- c(1:4, ".....", 199:202)
rownames(x) <- rna
knitr::kable(x, booktabs = TRUE, digits = 0, row.names = TRUE, 
             align = c("r", "l", "r"),
             caption = "Population by sex and age, Sweden 2016.")
```

Next the table of deaths by age and sex is read from disk.

```{r deaths, echo = TRUE}
deaths <- read.table("Data/BE0101D9.csv", header = TRUE,
                     stringsAsFactors = FALSE,
                     fileEncoding = "latin1")
```

The result is shown in Table \@ref(tab:scbpoptab).

```{r scbdeathtab,echo=FALSE}
##x <- list(t1 = pop[1:8, ], t2 = pop[195:202, ])
x <- deaths[1:4, ]
x$X2016 <- as.character(round(x$X2016))
x <- rbind(x, rep(".....", 3))
y <- deaths[199:202, ]
y$X2016 <- as.character(round(y$X2016))
x <- rbind(x, y)
rna <- c(1:4, ".....", 199:202)
rownames(x) <- rna
knitr::kable(x, booktabs = TRUE, digits = 0, row.names = TRUE, 
             align = c("r", "l", "r"),
             caption = "Deaths by sex and age, Sweden 2016.")
```

We concentrate on female mortality 2016 by combining the two tables after removing all information relating to men ("män") and translating to English.

```{r combines}
names(pop) <- c("age", "sex", "pop")
females <- pop[pop$sex == "kvinnor", c("age", "pop")]
females$age <- 0:100
females$deaths <- deaths$X2016[deaths[, 2] == "kvinnor"]
head(females, 4)
tail(females, 4)
```

Then we add two columns, derived from the original three.

```{r addtwo}
females$risk <- females$deaths / females$pop
alive <- numeric(101)
alive[1] <- 100000
for (i in 2:101){
    alive[i] <- alive[i - 1] * (1 - females$risk[i-1])
}
females$alive <- alive
```

It is constructed in the following way. The first column, headed by
_age_, contains the ages in completed years. The second column,
headed _pop_ contains the numbers of women in Sweden in the
corresponding ages. It is equal to the mean
population size over the year. Since population numbers from the SCB are
taken at the turn of the years, the numbers in column two are averages of
two columns in the SCB file. The third column is the total numbers of
deaths in each age category during the year.  The fourth and fifth columns
are derived from the previous ones. The _risk_ is essentially the
ratio between the number of deaths and population size for each age.

Column five, _alive at age $x$_, contains the actual construction of
the life table. It depicts the actual size of a birth cohort\index{cohort},
_year by year_,
exposed to the death risks of column four. It starts with 100000 newborn females.
Under the first year of life the death risk is 0.211 per cent, meaning that we
expect $0.00211 \times 100\,000 = 211$ girls to die the
first year. In other words, $100000 - 211 = 99789$ will remain alive
at the first anniversary (at exact age one year). That is the number in the
second row in the fifth column. The calculations then continues in the same
way through the last two columns. Note, though, that the last interval
(100+) is an open interval, i.e., it has no fixed upper limit.

Note the difference in interpretation between the numbers in the second
column ("pop"") and those in the last ("alive at age $x$"); the former
gives the age distribution in a population a given year (referred to as
_period data_), while the latter constitutes \emph{synthetic cohort
  data}\index{synthetic cohort}, i.e., a group of newborn are followed from
birth to death, and the
actual size of the (still alive) cohort is recorded age by age. That is,
``individuals'' in the synthetic cohort live their whole lives under the
mortality conditions of the year 2009. Of course no real individual can
experience this scenario, hence the name ``synthetic
cohort''. Nevertheless, it is a useful tool to illustrate the state of
affairs regarding mortality a given year.

It makes sense to plot the life table, see Figure \@ref(fig:lifetable). By
dividing all numbers by the original cohort size (in our case 100000), they
may be interpreted as _probabilities_.\index{life table|)}$\Box$